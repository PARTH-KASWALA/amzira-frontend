<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Confirmed | Amzira</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/header.css">
    <link rel="stylesheet" href="css/footer.css">
    
    <style>
        .success-page {
            padding: 100px 0 60px;
            background: linear-gradient(135deg, #FBF2DE 0%, #F5E6D3 100%);
            min-height: 100vh;
        }

        .success-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .success-card {
            background: white;
            border-radius: 16px;
            padding: 48px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .success-icon {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, #10B981, #059669);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 24px;
            animation: scaleIn 0.5s ease-out;
        }

        .success-icon i {
            font-size: 48px;
            color: white;
        }

        @keyframes scaleIn {
            from {
                transform: scale(0);
            }
            to {
                transform: scale(1);
            }
        }

        .success-title {
            font-size: 32px;
            font-family: var(--font-heading);
            color: var(--text-dark);
            margin-bottom: 12px;
        }

        .success-subtitle {
            font-size: 16px;
            color: var(--text-gray);
            margin-bottom: 32px;
        }

        .order-info {
            background: #fafafa;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 32px;
            text-align: left;
        }

        .order-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .order-row:last-child {
            border-bottom: none;
        }

        .order-label {
            font-size: 14px;
            color: var(--text-gray);
        }

        .order-value {
            font-size: 15px;
            font-weight: 600;
            color: var(--text-dark);
        }

        .order-id {
            font-size: 18px;
            color: var(--primary-color);
            font-family: monospace;
        }

        .delivery-info {
            background: rgba(139, 21, 56, 0.05);
            border: 2px dashed var(--primary-color);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 32px;
        }

        .delivery-info h3 {
            font-size: 16px;
            color: var(--primary-color);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .delivery-address {
            font-size: 14px;
            color: var(--text-dark);
            line-height: 1.6;
        }

        .items-summary {
            text-align: left;
            margin-bottom: 32px;
        }

        .items-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 16px;
        }

        .item-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .item-details {
            flex: 1;
        }

        .item-name {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-dark);
            margin-bottom: 4px;
        }

        .item-meta {
            font-size: 12px;
            color: var(--text-gray);
        }

        .item-price {
            font-size: 15px;
            font-weight: 600;
            color: var(--primary-color);
        }

        .action-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }

        .btn-action {
            padding: 16px;
            border-radius: 8px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
            border: none;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(139, 21, 56, 0.3);
        }

        .btn-secondary {
            background: white;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
        }

        .btn-secondary:hover {
            background: rgba(139, 21, 56, 0.05);
        }

        .back-home {
            text-align: center;
            margin-top: 24px;
        }

        .back-home a {
            color: var(--text-gray);
            font-size: 14px;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .back-home a:hover {
            color: var(--primary-color);
        }

        @media (max-width: 640px) {
            .success-card {
                padding: 32px 24px;
            }

            .success-title {
                font-size: 24px;
            }

            .action-buttons {
                grid-template-columns: 1fr;
            }
        }
    </style>
    <!-- Fallback styles for JavaScript-disabled browsers -->
    <noscript>
        <style>
            .mobile-menu {
                display: block !important;
                position: relative !important;
                transform: none !important;
                box-shadow: none;
                border-bottom: 1px solid var(--border-color);
            }

            .mobile-menu-toggle {
                display: none !important;
            }

            .nav-desktop {
                display: none !important;
            }

            @media (min-width: 1024px) {
                .mobile-menu {
                    display: none !important;
                }
                .nav-desktop {
                    display: flex !important;
                }
            }
        </style>
    </noscript>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <!-- Include your existing header -->
    </header>

    <!-- Success Page -->
    <main class="success-page">
        <div class="success-container">
            <div class="success-card">
                <!-- Success Icon -->
                <div class="success-icon">
                    <i class="fas fa-check"></i>
                </div>

                <!-- Title -->
                <h1 class="success-title">Order Confirmed!</h1>
                <p class="success-subtitle">Thank you for shopping with Amzira</p>
                <p class="success-subtitle" id="emailStatusMessage" style="margin-top: -16px; margin-bottom: 28px;">Order placed - confirmation email sent.</p>

                <!-- Order Info -->
                <div class="order-info">
                    <div class="order-row">
                        <span class="order-label">Order ID</span>
                        <span class="order-value order-id" id="orderId">-</span>
                    </div>
                    <div class="order-row">
                        <span class="order-label">Order Date</span>
                        <span class="order-value" id="orderDate">-</span>
                    </div>
                    <div class="order-row">
                        <span class="order-label">Total Amount</span>
                        <span class="order-value" id="orderTotal">‚Çπ0</span>
                    </div>
                    <div class="order-row">
                        <span class="order-label">Payment Method</span>
                        <span class="order-value" id="paymentMethod">-</span>
                    </div>
                    <div class="order-row">
                        <span class="order-label">Expected Delivery</span>
                        <span class="order-value" id="deliveryDate">-</span>
                    </div>
                </div>

                <!-- Delivery Info -->
                <div class="delivery-info">
                    <h3>
                        <i class="fas fa-shipping-fast"></i>
                        Delivering To
                    </h3>
                    <div class="delivery-address" id="deliveryAddress">
                        <!-- Address will be loaded here -->
                    </div>
                </div>

                <!-- Items Summary -->
                <div class="items-summary">
                    <h3 class="items-title">Order Items</h3>
                    <div id="itemsList">
                        <!-- Items will be loaded here -->
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="action-buttons">
                    <a href="account.html" class="btn-action btn-secondary">
                        <i class="fas fa-user"></i>
                        View Orders
                    </a>
                    <a href="index.html" class="btn-action btn-primary">
                        <i class="fas fa-shopping-bag"></i>
                        Continue Shopping
                    </a>
                </div>

                <!-- Back Home -->
                <div class="back-home">
                    <a href="index.html">
                        <i class="fas fa-home"></i>
                        Back to Homepage
                    </a>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <!-- FEATURES STRIP (Top of Footer) -->
<section class="features-strip">
  <div class="features-container">
        <div class="feature-item">
            <img src="images/icons/MADE IN INDIA.svg" class="feature-icon feature-icon-svg" alt="Made in India">
            <h4>MADE IN INDIA</h4>
        </div>
        <div class="feature-item">
            <img src="images/icons/ASSURED QUALITY.svg" class="feature-icon feature-icon-svg" alt="Assured Quality">
            <h4>ASSURED QUALITY</h4>
        </div>
        <div class="feature-item">
            <img src="images/icons/SECURE PAYMENTS.svg" class="feature-icon feature-icon-svg" alt="Secure Payments">
            <h4>SECURE PAYMENTS</h4>
        </div>
        <div class="feature-item">
            <img src="images/icons/EMPOWERING WEAVERS.svg" class="feature-icon feature-icon-svg" alt="Empowering Weavers">
            <h4>EMPOWERING WEAVERS</h4>
        </div>
        <div class="feature-item">
            <img src="images/icons/24x7 Customer Support.svg" class="feature-icon feature-icon-svg" alt="24x7 Customer Support">
            <h4>24√ó7 CUSTOMER SUPPORT</h4>
        </div>
  </div>
</section>

<!-- MAIN FOOTER -->
<footer class="main-footer">
  <div class="footer-content">
    
    <!-- Brand Section -->
    <div class="footer-column brand-column footer-brand">
      <div class="brand-row">
        <img src="images/logo/Amzira_logo.png" class="brand-logo" alt="Amzira logo">
        <img src="images/logo/Amzira_name.png" class="brand-name" alt="Amzira">
      </div>
      <p class="brand-tagline">Premium Indian Ethnic Wear</p>
    </div>

    <!-- Categories -->
    <div class="footer-column">
      <h3 class="footer-heading">CATEGORIES</h3>
      <ul class="footer-links">
        <li><a href="men.html?cat=kurta-pajama">Kurta Pajama</a></li>
        <li><a href="men.html?cat=kurta-jacket-set">Kurta Jacket Sets</a></li>
        <li><a href="men.html?cat=only-kurta">Only Kurtas</a></li>
        <li><a href="men.html?cat=nehru-jacket">Nehru Jackets</a></li>
        <li><a href="men.html?cat=indo-western">Indo Western</a></li>
        <li><a href="men.html?cat=sherwani">Sherwani</a></li>
        <li><a href="women.html?cat=lehenga">Lehenga</a></li>
        <li><a href="women.html?cat=sarees">Saree</a></li>
        <li><a href="kids.html">Kidswear</a></li>
        <li><a href="women.html?cat=accessories">Accessories</a></li>
      </ul>
    </div>

    <!-- Support -->
    <div class="footer-column">
      <h3 class="footer-heading">SUPPORT</h3>
      <ul class="footer-links">
        <li><a href="order-tracking.html">Track Order</a></li>
        <li><a href="contact-support.html">Contact Us</a></li>
        <li><a href="account.html">My Account</a></li>
      </ul>
    </div>

    <!-- Quick Links -->
    <div class="footer-column">
      <h3 class="footer-heading">QUICK LINKS</h3>
      <ul class="footer-links">
        <li><a href="index.html">About Us</a></li>
        <li><a href="index.html">Brand Story</a></li>
        <li><a href="index.html">Blogs</a></li>
        <li><a href="contact-support.html">Careers</a></li>
        <li><a href="appointments.html">Book a Video Call</a></li>
        <li><a href="stores.html">Store Locator</a></li>
      </ul>
    </div>

    <!-- Our Policies -->
    <div class="footer-column">
      <h3 class="footer-heading">OUR POLICIES</h3>
      <ul class="footer-links">
        <li><a href="faqs.html">FAQs</a></li>
        <li><a href="shipping-policy.html">Shipping Details</a></li>
        <li><a href="returns-refund-policy.html">Return, Exchange and Refund Policy</a></li>
        <li><a href="terms-and-conditions.html">Terms of Use</a></li>
        <li><a href="privacy-policy.html">Privacy Policy</a></li>
        <li><a href="privacy-policy.html#cookie-policy">Cookie Policy</a></li>
      </ul>
    </div>

    <!-- Contact -->
    <div class="footer-column">
      <h3 class="footer-heading">CONTACT</h3>
      <ul class="footer-links contact-links">
        <li><a href="mailto:care@amzira.com">care@amzira.com</a></li>
        <li><a href="tel:+911800120000500">Call us at: 1800-120-000-500 (India)</a></li>
        <li><a href="tel:+919674373838">+91 9674373838 (International)</a></li>
        <li class="timing">10 am - 7 pm, Monday ‚Äì Saturday</li>
      </ul>
      
      <!-- Social Media -->
      <div class="social-icons">
        <h4 class="social-heading">KEEP IN TOUCH</h4>
        <div class="social-links">
          <a href="https://www.facebook.com/" target="_blank" rel="noopener" aria-label="Facebook">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
            </svg>
          </a>
          <a href="https://x.com/" target="_blank" rel="noopener" aria-label="Twitter">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/>
            </svg>
          </a>
          <a href="https://www.instagram.com/" target="_blank" rel="noopener" aria-label="Instagram">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 0C8.74 0 8.333.015 7.053.072 5.775.132 4.905.333 4.14.63c-.789.306-1.459.717-2.126 1.384S.935 3.35.63 4.14C.333 4.905.131 5.775.072 7.053.012 8.333 0 8.74 0 12s.015 3.667.072 4.947c.06 1.277.261 2.148.558 2.913.306.788.717 1.459 1.384 2.126.667.666 1.336 1.079 2.126 1.384.766.296 1.636.499 2.913.558C8.333 23.988 8.74 24 12 24s3.667-.015 4.947-.072c1.277-.06 2.148-.262 2.913-.558.788-.306 1.459-.718 2.126-1.384.666-.667 1.079-1.335 1.384-2.126.296-.765.499-1.636.558-2.913.06-1.28.072-1.687.072-4.947s-.015-3.667-.072-4.947c-.06-1.277-.262-2.149-.558-2.913-.306-.789-.718-1.459-1.384-2.126C21.319 1.347 20.651.935 19.86.63c-.765-.297-1.636-.499-2.913-.558C15.667.012 15.26 0 12 0zm0 2.16c3.203 0 3.585.016 4.85.071 1.17.055 1.805.249 2.227.415.562.217.96.477 1.382.896.419.42.679.819.896 1.381.164.422.36 1.057.413 2.227.057 1.266.07 1.646.07 4.85s-.015 3.585-.074 4.85c-.061 1.17-.256 1.805-.421 2.227-.224.562-.479.96-.899 1.382-.419.419-.824.679-1.38.896-.42.164-1.065.36-2.235.413-1.274.057-1.649.07-4.859.07-3.211 0-3.586-.015-4.859-.074-1.171-.061-1.816-.256-2.236-.421-.569-.224-.96-.479-1.379-.899-.421-.419-.69-.824-.9-1.38-.165-.42-.359-1.065-.42-2.235-.045-1.26-.061-1.649-.061-4.844 0-3.196.016-3.586.061-4.861.061-1.17.255-1.814.42-2.234.21-.57.479-.96.9-1.381.419-.419.81-.689 1.379-.898.42-.166 1.051-.361 2.221-.421 1.275-.045 1.65-.06 4.859-.06l.045.03zm0 3.678c-3.405 0-6.162 2.76-6.162 6.162 0 3.405 2.76 6.162 6.162 6.162 3.405 0 6.162-2.76 6.162-6.162 0-3.405-2.76-6.162-6.162-6.162zM12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm7.846-10.405c0 .795-.646 1.44-1.44 1.44-.795 0-1.44-.646-1.44-1.44 0-.794.646-1.439 1.44-1.439.793-.001 1.44.645 1.44 1.439z"/>
            </svg>
          </a>
          <a href="https://www.linkedin.com/" target="_blank" rel="noopener" aria-label="LinkedIn">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
            </svg>
          </a>
          <a href="https://www.youtube.com/" target="_blank" rel="noopener" aria-label="YouTube">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
            </svg>
          </a>
          <a href="https://www.pinterest.com/" target="_blank" rel="noopener" aria-label="Pinterest">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607 0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017 0z"/>
            </svg>
          </a>
        </div>
      </div>
    </div>

  </div>

  
<footer class="footer-bar">
  <div class="footer-left">
    <span class="brand">amzira</span>
    <span class="country">üåê India</span>
  </div>

  <div class="footer-center">
    ¬© 2025 Amzira Ltd. All rights reserved.
  </div>

  <div class="footer-right">
    <span class="secure-text">100% Secure Payments</span>
    <div class="payments">
      <img src="payment-visa.png" alt="Visa">
      <img src="mastercard.png" alt="Mastercard">
      <img src="rupay.png" alt="RuPay">
      <img src="upi.png" alt="UPI">
    </div>
  </div>
</footer>
 

    <!-- Scripts -->
    <script src="js/api.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/address.js"></script>
    <script src="js/order.js"></script>
    
    <script>
        // Require login
        if (!Auth.requireLogin('order-success.html')) {
            // Will redirect to login
        }

        function esc(value) {
            if (window.AMZIRA?.utils?.escapeHtml) return window.AMZIRA.utils.escapeHtml(value);
            const div = document.createElement('div');
            div.textContent = value == null ? '' : String(value);
            return div.innerHTML;
        }

        function getApiMessage(error, fallback) {
            if (window.AMZIRA?.utils?.getApiErrorMessage) {
                return window.AMZIRA.utils.getApiErrorMessage(error, fallback);
            }
            return error?.message || fallback;
        }

        function renderEmailStatus(order) {
            const messageEl = document.getElementById('emailStatusMessage');
            const emailStatus = String(order?.email_status || '').toLowerCase();
            const emailSent = order?.email_sent === true || ['sent', 'queued', 'delivered'].includes(emailStatus);
            const emailFailed = order?.email_sent === false || ['failed', 'bounced'].includes(emailStatus);

            if (emailSent) {
                messageEl.textContent = 'Order placed - confirmation email sent.';
                messageEl.style.color = '#0f766e';
                return;
            }

            if (emailFailed) {
                messageEl.textContent = 'Order placed - we could not confirm email delivery. Please check your orders in account.';
                messageEl.style.color = '#9a3412';
                return;
            }

            messageEl.textContent = 'Order placed - confirmation email is being processed.';
            messageEl.style.color = '#475569';
        }

        function renderDeliveryAddress(address) {
            const node = document.getElementById('deliveryAddress');
            const name = esc(address?.name || address?.full_name || '');
            const address1 = esc(address?.address || address?.address_line1 || '');
            const address2 = esc(address?.locality || address?.address_line2 || '');
            const city = esc(address?.city || '');
            const state = esc(address?.state || '');
            const pincode = esc(address?.pincode || '');
            const phone = esc(address?.mobile || address?.phone || '');

            node.innerHTML = `
                <strong>${name}</strong><br>
                ${address1}${address2 ? `, ${address2}` : ''}, ${city}, ${state} - ${pincode}<br>
                <strong>Phone:</strong> ${phone}
            `;
        }

        function renderItems(items) {
            const list = document.getElementById('itemsList');
            list.innerHTML = (items || []).map((item) => `
                <div class="item-row">
                    <div class="item-details">
                        <div class="item-name">${esc(item?.name || item?.product_name || 'Item')}</div>
                        <div class="item-meta">Size: ${esc(item?.size || item?.variant?.size || '-')} | Qty: ${Number(item?.quantity || 0)}</div>
                    </div>
                    <div class="item-price">‚Çπ${(Number(item?.price || item?.unit_price || 0) * Number(item?.quantity || 0)).toLocaleString('en-IN')}</div>
                </div>
            `).join('');
        }

        function handleTerminalOrderStatus(order) {
            const orderStatus = String(order?.status || order?.order_status || '').toLowerCase();
            const paymentStatus = String(order?.payment_status || '').toLowerCase();
            if (orderStatus === 'cancelled' || orderStatus === 'canceled') {
                if (window.errorHandler?.showWarning) {
                    window.errorHandler.showWarning('This order was cancelled. You can retry payment or return to cart.');
                }
                // Soft-launch blocker closure
                window.location.href = 'payment-failure.html?reason=order_cancelled';
                return true;
            }
            if (orderStatus === 'expired') {
                if (window.errorHandler?.showWarning) {
                    window.errorHandler.showWarning('This order expired before completion. Please retry checkout.');
                }
                // Soft-launch blocker closure
                window.location.href = 'payment-failure.html?reason=order_expired';
                return true;
            }
            if (paymentStatus === 'failed') {
                // Soft-launch blocker closure
                window.location.href = 'payment-failure.html?reason=payment_failed';
                return true;
            }
            return false;
        }

        async function loadOrderDetail() {
            const params = new URLSearchParams(window.location.search);
            const orderRef = params.get('order');
            if (!orderRef) {
                window.location.href = 'index.html';
                return;
            }

            const order = await window.AMZIRA.orders.getOrderDetail(orderRef);
            if (!order || typeof order !== 'object') {
                throw new Error('Invalid order response from server.');
            }

            if (handleTerminalOrderStatus(order)) return;

            const orderId = order?.order_number || order?.order_id || order?.id || orderRef;
            document.getElementById('orderId').textContent = orderId;

            const createdAt = order?.created_at || order?.order_date || new Date().toISOString();
            document.getElementById('orderDate').textContent = new Date(createdAt).toLocaleDateString('en-IN', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });

            const total = Number(order?.total || order?.grand_total || 0);
            document.getElementById('orderTotal').textContent = `‚Çπ${total.toLocaleString('en-IN')}`;

            const paymentMethod = String(order?.payment_method || '').toLowerCase();
            document.getElementById('paymentMethod').textContent = paymentMethod === 'cod' || paymentMethod === 'cash_on_delivery'
                ? 'Cash on Delivery'
                : 'Online Payment';

            const deliveryDateRaw = order?.estimated_delivery || order?.expected_delivery;
            if (deliveryDateRaw) {
                document.getElementById('deliveryDate').textContent = new Date(deliveryDateRaw).toLocaleDateString('en-IN', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
            } else {
                document.getElementById('deliveryDate').textContent = 'Will be updated soon';
            }

            renderDeliveryAddress(order?.shipping_address || order?.deliveryAddress || {});
            renderItems(order?.items || order?.order_items || []);
            renderEmailStatus(order);
        }

        document.addEventListener('DOMContentLoaded', async function() {
            try {
                await loadOrderDetail();
            } catch (error) {
                const message = getApiMessage(error, 'Unable to load order details.');
                if (window.errorHandler?.showError) {
                    window.errorHandler.showError(message);
                } else {
                    alert(message);
                }
                window.location.href = 'account.html';
            }
        });
    </script>
</body>
</html>
